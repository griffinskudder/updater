
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Go-based software update service">
      
      
        <meta name="author" content="Updater Service Team">
      
      
        <link rel="canonical" href="https://griffinskudder.github.io/updater/dev/SECURITY/">
      
      
        <link rel="prev" href="../ARCHITECTURE/">
      
      
        <link rel="next" href="../DEPLOYMENT_SECURITY/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Overview - Updater Service Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#security-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Updater Service Documentation" class="md-header__button md-logo" aria-label="Updater Service Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Updater Service Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/griffinskudder/updater" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    updater
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../ROADMAP/" class="md-tabs__link">
        
  
  
    
  
  Roadmap

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../use-cases/" class="md-tabs__link">
        
  
  
    
  
  Use Cases

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/" class="md-tabs__link">
          
  
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../ARCHITECTURE/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../rate-limiting/" class="md-tabs__link">
        
  
  
    
  
  Rate Limiting

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../logging/" class="md-tabs__link">
        
  
  
    
  
  Logging

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../storage/" class="md-tabs__link">
        
  
  
    
  
  Storage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../observability/" class="md-tabs__link">
        
  
  
    
  
  Observability

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../makefile/" class="md-tabs__link">
        
  
  
    
  
  Makefile

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../models/" class="md-tabs__link">
          
  
  
  Models

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../db/" class="md-tabs__link">
          
  
  
  Database

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Updater Service Documentation" class="md-nav__button md-logo" aria-label="Updater Service Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Updater Service Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/griffinskudder/updater" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    updater
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ROADMAP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../use-cases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use Cases
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenAPI Spec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Admin UI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ARCHITECTURE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defense-in-depth-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defense in Depth Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Layers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication &amp; Authorization
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication &amp; Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-key-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Key Authentication
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permission Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permission Hierarchy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Key Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Key Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bootstrap-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bootstrap Key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-lifecycle-rest-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Lifecycle (REST API)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permission Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Best Practices
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Threat Model
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threat Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identified-threats" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identified Threats
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-scenarios-defenses" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attack Scenarios &amp; Defenses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-security-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Production Security Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Production Security Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#httpstls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTPS/TLS Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rate Limiting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-proxy-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverse Proxy Security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-monitoring-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Monitoring &amp; Logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Monitoring &amp; Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Log Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-alerts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring Alerts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#incident-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Incident Response
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Incident Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-incident-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Incident Procedures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emergency-api-key-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Emergency API Key Revocation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-validation-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Validation Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#penetration-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Penetration Testing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-standards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compliance &amp; Standards
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance &amp; Standards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-standards-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Standards Alignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-protection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Protection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-development-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Development Guidelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Development Guidelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secure-coding-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secure Coding Practices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-review-security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Review Security Checklist
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-contact-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Contact Information
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Contact Information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#responsible-disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Responsible Disclosure
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security References
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Tools
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEPLOYMENT_SECURITY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rate-limiting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rate Limiting
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../makefile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Makefile
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/auto/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Database
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Database
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/public.applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    applications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/public.releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    releases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/public.api_keys/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    api_keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defense-in-depth-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defense in Depth Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-layers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Layers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication &amp; Authorization
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication &amp; Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-key-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Key Authentication
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permission Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permission Hierarchy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Key Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Key Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bootstrap-key" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bootstrap Key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-lifecycle-rest-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Lifecycle (REST API)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permission Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Best Practices
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threat-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Threat Model
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threat Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identified-threats" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identified Threats
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-scenarios-defenses" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attack Scenarios &amp; Defenses
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-security-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Production Security Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Production Security Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#httpstls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTPS/TLS Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rate Limiting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-proxy-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reverse Proxy Security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-monitoring-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Monitoring &amp; Logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Monitoring &amp; Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Log Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-alerts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring Alerts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#incident-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Incident Response
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Incident Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-incident-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Incident Procedures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emergency-api-key-revocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Emergency API Key Revocation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-validation-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Validation Checklist
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#penetration-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Penetration Testing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compliance-standards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Compliance &amp; Standards
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compliance &amp; Standards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-standards-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Standards Alignment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-protection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Protection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-development-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Development Guidelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Development Guidelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#secure-coding-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Secure Coding Practices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-review-security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Review Security Checklist
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-contact-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Contact Information
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Contact Information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#responsible-disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Responsible Disclosure
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security References
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Tools
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href=".." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    Security
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="security-documentation">Security Documentation<a class="headerlink" href="#security-documentation" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The updater service implements a comprehensive security model designed to protect against common attack vectors while providing flexible access control for administrative operations. This document outlines the security architecture, configuration, and best practices for secure deployment.</p>
<h2 id="security-architecture">Security Architecture<a class="headerlink" href="#security-architecture" title="Permanent link">&para;</a></h2>
<h3 id="defense-in-depth-strategy">Defense in Depth Strategy<a class="headerlink" href="#defense-in-depth-strategy" title="Permanent link">&para;</a></h3>
<p>The service implements multiple layers of security protection:</p>
<pre class="mermaid"><code>graph TB
    A[Client Request] --&gt; B[Rate Limiting]
    B --&gt; C[CORS Protection]
    C --&gt; D[TLS Termination]
    D --&gt; E[Authentication]
    E --&gt; F[Authorization]
    F --&gt; G[Input Validation]
    G --&gt; H[Business Logic]
    H --&gt; I[Audit Logging]</code></pre>
<h3 id="security-layers">Security Layers<a class="headerlink" href="#security-layers" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Network Security</strong></li>
<li>TLS/HTTPS enforcement</li>
<li>CORS protection with configurable origins</li>
<li>
<p>Trusted proxy configuration</p>
</li>
<li>
<p><strong>Authentication Layer</strong></p>
</li>
<li>API key-based authentication</li>
<li>Bearer token format validation</li>
<li>
<p>Key rotation and management</p>
</li>
<li>
<p><strong>Authorization Layer</strong></p>
</li>
<li>Permission-based access control</li>
<li>Endpoint-specific permission requirements</li>
<li>
<p>Principle of least privilege</p>
</li>
<li>
<p><strong>Application Security</strong></p>
</li>
<li>Input validation and sanitization</li>
<li>SQL injection prevention</li>
<li>
<p>Path traversal protection</p>
</li>
<li>
<p><strong>Operational Security</strong></p>
</li>
<li>Rate limiting and DDoS protection</li>
<li>Comprehensive audit logging</li>
<li>Security event monitoring</li>
</ol>
<h2 id="authentication-authorization">Authentication &amp; Authorization<a class="headerlink" href="#authentication-authorization" title="Permanent link">&para;</a></h2>
<h3 id="api-key-authentication">API Key Authentication<a class="headerlink" href="#api-key-authentication" title="Permanent link">&para;</a></h3>
<p>The service uses API keys for authentication with a Bearer token format:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="err">Authorization: Bearer &lt;api-key&gt;</span>
</span></code></pre></div>
<h3 id="permission-model">Permission Model<a class="headerlink" href="#permission-model" title="Permanent link">&para;</a></h3>
<p>The authorization system implements role-based permissions:</p>
<table>
<thead>
<tr>
<th>Permission</th>
<th>Description</th>
<th>Endpoints</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read</code></td>
<td>Query update information</td>
<td><code>GET /api/v1/updates/*</code></td>
</tr>
<tr>
<td><code>write</code></td>
<td>Register new releases</td>
<td><code>POST /api/v1/updates/*/register</code></td>
</tr>
<tr>
<td><code>admin</code></td>
<td>Full administrative access</td>
<td>All endpoints</td>
</tr>
</tbody>
</table>
<h3 id="permission-hierarchy">Permission Hierarchy<a class="headerlink" href="#permission-hierarchy" title="Permanent link">&para;</a></h3>
<ul>
<li><code>admin</code> permission grants access to all operations</li>
<li><code>write</code> permission includes <code>read</code> operations</li>
<li><code>read</code> permission grants only query access</li>
</ul>
<h2 id="api-key-management">API Key Management<a class="headerlink" href="#api-key-management" title="Permanent link">&para;</a></h2>
<p>API keys are stored in the service database, not in the configuration file.</p>
<h3 id="bootstrap-key">Bootstrap Key<a class="headerlink" href="#bootstrap-key" title="Permanent link">&para;</a></h3>
<p>The <code>security.bootstrap_key</code> config field (or <code>UPDATER_BOOTSTRAP_KEY</code> env var)
seeds a single <code>admin</code>-permission key into an empty database on first startup.
This key is the entry point for all subsequent key management.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">enable_auth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="nt">bootstrap_key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${UPDATER_BOOTSTRAP_KEY}&quot;</span>
</span></code></pre></div>
<p>Generate a bootstrap key:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">32</span>
</span></code></pre></div>
<h3 id="key-format">Key Format<a class="headerlink" href="#key-format" title="Permanent link">&para;</a></h3>
<p>Generated keys use the format <code>upd_&lt;44-char base64url&gt;</code>, providing 256 bits of
entropy. The raw key value is returned exactly once  at creation time  and is
never stored. Only the SHA-256 hex digest (<code>key_hash</code>) and an 8-character
display prefix are persisted.</p>
<h3 id="key-lifecycle-rest-api">Key Lifecycle (REST API)<a class="headerlink" href="#key-lifecycle-rest-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GET</code></td>
<td><code>/api/v1/admin/keys</code></td>
<td>List all keys (hash and raw key never returned)</td>
</tr>
<tr>
<td><code>POST</code></td>
<td><code>/api/v1/admin/keys</code></td>
<td>Create a key; raw value returned once in response</td>
</tr>
<tr>
<td><code>PATCH</code></td>
<td><code>/api/v1/admin/keys/{id}</code></td>
<td>Update name, permissions, or enabled status</td>
</tr>
<tr>
<td><code>DELETE</code></td>
<td><code>/api/v1/admin/keys/{id}</code></td>
<td>Permanently revoke a key</td>
</tr>
</tbody>
</table>
<p>All key management endpoints require <code>admin</code> permission. The admin UI at
<code>/admin/keys</code> and <code>/admin/keys/new</code> provides a browser-based interface for the
same operations.</p>
<h3 id="permission-model_1">Permission Model<a class="headerlink" href="#permission-model_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Permission</th>
<th>Grants access to</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read</code></td>
<td>Read-only query endpoints</td>
</tr>
<tr>
<td><code>write</code></td>
<td><code>read</code> + release and application creation</td>
</tr>
<tr>
<td><code>admin</code></td>
<td><code>write</code> + updates, deletes, and key management</td>
</tr>
<tr>
<td><code>*</code></td>
<td>Alias for <code>admin</code>  full access</td>
</tr>
</tbody>
</table>
<p>Permissions are cumulative: <code>admin</code> includes <code>write</code>, <code>write</code> includes <code>read</code>.</p>
<h3 id="security-best-practices">Security Best Practices<a class="headerlink" href="#security-best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Key Rotation</strong>: Rotate keys regularly (recommended: every 90 days). Create
   the replacement key before revoking the old one for zero-downtime rotation.</p>
</li>
<li>
<p><strong>Least Privilege</strong>: Assign the minimum permission required. Read-only
   integrations should use <code>read</code>; release publishers should use <code>write</code>.</p>
</li>
<li>
<p><strong>Bootstrap Key Storage</strong>: Store the bootstrap key in a secret manager
   (HashiCorp Vault, AWS Secrets Manager, Kubernetes Secrets). Never commit it
   to version control.</p>
</li>
<li>
<p><strong>Revocation</strong>: Revoke compromised keys immediately via <code>DELETE
   /api/v1/admin/keys/{id}</code> or the <code>/admin/keys</code> UI.</p>
</li>
</ol>
<h2 id="configuration-security">Configuration Security<a class="headerlink" href="#configuration-security" title="Permanent link">&para;</a></h2>
<h2 id="threat-model">Threat Model<a class="headerlink" href="#threat-model" title="Permanent link">&para;</a></h2>
<h3 id="identified-threats">Identified Threats<a class="headerlink" href="#identified-threats" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Threat</th>
<th>Impact</th>
<th>Mitigation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Unauthorized Release Injection</strong></td>
<td>Critical</td>
<td>Permission-based authorization, API key validation</td>
</tr>
<tr>
<td><strong>DDoS/Resource Exhaustion</strong></td>
<td>High</td>
<td>Rate limiting, connection limits</td>
</tr>
<tr>
<td><strong>API Key Compromise</strong></td>
<td>High</td>
<td>Key rotation, permission scoping, audit logging</td>
</tr>
<tr>
<td><strong>Man-in-the-Middle</strong></td>
<td>High</td>
<td>TLS enforcement, HSTS headers</td>
</tr>
<tr>
<td><strong>Version Downgrade Attack</strong></td>
<td>Medium</td>
<td>Checksum validation, version constraints</td>
</tr>
<tr>
<td><strong>Information Disclosure</strong></td>
<td>Medium</td>
<td>Error message sanitization, access logging</td>
</tr>
</tbody>
</table>
<h3 id="attack-scenarios-defenses">Attack Scenarios &amp; Defenses<a class="headerlink" href="#attack-scenarios-defenses" title="Permanent link">&para;</a></h3>
<h4 id="1-malicious-release-injection">1. Malicious Release Injection<a class="headerlink" href="#1-malicious-release-injection" title="Permanent link">&para;</a></h4>
<p><strong>Scenario</strong>: Attacker attempts to register malicious releases</p>
<p><strong>Defense</strong>:
- API key authentication required
- <code>write</code> permission enforcement
- Input validation on all release data
- Audit logging of all release operations</p>
<h4 id="2-api-key-compromise">2. API Key Compromise<a class="headerlink" href="#2-api-key-compromise" title="Permanent link">&para;</a></h4>
<p><strong>Scenario</strong>: API key is stolen or leaked</p>
<p><strong>Defense</strong>:
- Permission scoping limits damage
- Rate limiting prevents mass operations
- Audit logging enables detection
- Key rotation capability for quick response</p>
<h4 id="3-ddos-attack">3. DDoS Attack<a class="headerlink" href="#3-ddos-attack" title="Permanent link">&para;</a></h4>
<p><strong>Scenario</strong>: Service overwhelmed by requests</p>
<p><strong>Defense</strong>:
- Per-IP rate limiting
- Request size limits
- Connection timeouts
- Graceful degradation</p>
<h2 id="production-security-configuration">Production Security Configuration<a class="headerlink" href="#production-security-configuration" title="Permanent link">&para;</a></h2>
<h3 id="httpstls-configuration">HTTPS/TLS Configuration<a class="headerlink" href="#httpstls-configuration" title="Permanent link">&para;</a></h3>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="nt">tls_enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="nt">tls_cert_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/etc/ssl/certs/updater.pem&quot;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="nt">tls_key_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/etc/ssl/private/updater.key&quot;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="c1"># Security headers</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="nt">cors</span><span class="p">:</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="nt">allowed_origins</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;https://yourdomain.com&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span><span class="nt">allowed_methods</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;GET&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;POST&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span><span class="nt">max_age</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">86400</span>
</span></code></pre></div>
<h3 id="rate-limiting">Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permanent link">&para;</a></h3>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">rate_limit</span><span class="p">:</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="nt">requests_per_minute</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="nt">burst_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="nt">authenticated_requests_per_minute</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="nt">authenticated_burst_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="nt">cleanup_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300s</span>
</span></code></pre></div>
<h3 id="reverse-proxy-security">Reverse Proxy Security<a class="headerlink" href="#reverse-proxy-security" title="Permanent link">&para;</a></h3>
<p>When using reverse proxies (nginx, Cloudflare):</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="nt">trusted_proxies</span><span class="p">:</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10.0.0.0/8&quot;</span><span class="w">      </span><span class="c1"># Internal network</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;172.16.0.0/12&quot;</span><span class="w">   </span><span class="c1"># Docker networks</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16&quot;</span><span class="w">  </span><span class="c1"># Local networks</span>
</span></code></pre></div>
<h2 id="security-monitoring-logging">Security Monitoring &amp; Logging<a class="headerlink" href="#security-monitoring-logging" title="Permanent link">&para;</a></h2>
<h3 id="security-events">Security Events<a class="headerlink" href="#security-events" title="Permanent link">&para;</a></h3>
<p>The service logs the following security-relevant events:</p>
<ul>
<li><strong>Authentication Events</strong></li>
<li>API key validation attempts (success/failure)</li>
<li>Invalid authentication format attempts</li>
<li>
<p>Disabled key usage attempts</p>
</li>
<li>
<p><strong>Authorization Events</strong></p>
</li>
<li>Permission validation failures</li>
<li>Unauthorized endpoint access attempts</li>
<li>
<p>Admin operation attempts without proper permissions</p>
</li>
<li>
<p><strong>Rate Limiting Events</strong></p>
</li>
<li>Rate limit violations by IP</li>
<li>Sustained attack patterns</li>
<li>
<p>Burst limit exceeded events</p>
</li>
<li>
<p><strong>Operational Events</strong></p>
</li>
<li>Release registration operations</li>
<li>Configuration changes</li>
<li>Service startup/shutdown</li>
</ul>
<h3 id="log-format">Log Format<a class="headerlink" href="#log-format" title="Permanent link">&para;</a></h3>
<div class="language-json highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-15T10:30:00Z&quot;</span><span class="p">,</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;WARN&quot;</span><span class="p">,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auth_failure&quot;</span><span class="p">,</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid API key attempted&quot;</span><span class="p">,</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="nt">&quot;client_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.100&quot;</span><span class="p">,</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/api/v1/updates/myapp/register&quot;</span><span class="p">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">  </span><span class="nt">&quot;user_agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;curl/7.68.0&quot;</span><span class="p">,</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span><span class="nt">&quot;request_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;req_123456&quot;</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="monitoring-alerts">Monitoring Alerts<a class="headerlink" href="#monitoring-alerts" title="Permanent link">&para;</a></h3>
<p>Set up alerts for:
- Multiple authentication failures from same IP
- Admin operations outside business hours
- Unusual API usage patterns
- Rate limit violations
- Service error rate increases</p>
<h2 id="incident-response">Incident Response<a class="headerlink" href="#incident-response" title="Permanent link">&para;</a></h2>
<h3 id="security-incident-procedures">Security Incident Procedures<a class="headerlink" href="#security-incident-procedures" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Immediate Response</strong></li>
<li>Identify compromised API keys</li>
<li>Disable affected keys immediately</li>
<li>
<p>Review audit logs for unauthorized operations</p>
</li>
<li>
<p><strong>Investigation</strong></p>
</li>
<li>Analyze access patterns</li>
<li>Identify affected releases/applications</li>
<li>
<p>Determine attack timeline and scope</p>
</li>
<li>
<p><strong>Recovery</strong></p>
</li>
<li>Generate new API keys</li>
<li>Update affected systems</li>
<li>Verify system integrity</li>
<li>
<p>Update security configurations</p>
</li>
<li>
<p><strong>Post-Incident</strong></p>
</li>
<li>Document lessons learned</li>
<li>Update security procedures</li>
<li>Enhance monitoring rules</li>
</ol>
<h3 id="emergency-api-key-revocation">Emergency API Key Revocation<a class="headerlink" href="#emergency-api-key-revocation" title="Permanent link">&para;</a></h3>
<p>Revoke a key immediately via the REST API (requires an active <code>admin</code> key):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Permanently delete a key by ID</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>curl<span class="w"> </span>-X<span class="w"> </span>DELETE<span class="w"> </span>https://updater.example.com/api/v1/admin/keys/&lt;key-id&gt;<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer &lt;admin-api-key&gt;&quot;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1"># Or disable without deleting (can be re-enabled later)</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>curl<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span>https://updater.example.com/api/v1/admin/keys/&lt;key-id&gt;<span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer &lt;admin-api-key&gt;&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;enabled&quot;: false}&#39;</span>
</span></code></pre></div>
<p>Key IDs are visible in <code>GET /api/v1/admin/keys</code> or the <code>/admin/keys</code> admin UI.</p>
<h2 id="security-testing">Security Testing<a class="headerlink" href="#security-testing" title="Permanent link">&para;</a></h2>
<h3 id="security-validation-checklist">Security Validation Checklist<a class="headerlink" href="#security-validation-checklist" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] API authentication required for admin endpoints</li>
<li>[ ] Permission validation enforced</li>
<li>[ ] Rate limiting functional</li>
<li>[ ] Input validation preventing injection</li>
<li>[ ] Error messages don't leak sensitive information</li>
<li>[ ] HTTPS enforced in production</li>
<li>[ ] Security headers configured</li>
<li>[ ] Audit logging captures security events</li>
</ul>
<h3 id="penetration-testing">Penetration Testing<a class="headerlink" href="#penetration-testing" title="Permanent link">&para;</a></h3>
<p>Recommended security tests:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Test authentication bypass</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8080/api/v1/updates/test/register<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;version&quot;:&quot;1.0.0&quot;}&#39;</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1"># Test invalid API key</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8080/api/v1/updates/test/register<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer invalid-key&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;version&quot;:&quot;1.0.0&quot;}&#39;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c1"># Test insufficient permissions</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8080/api/v1/updates/test/register<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer read-only-key&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;version&quot;:&quot;1.0.0&quot;}&#39;</span>
</span></code></pre></div>
<h2 id="compliance-standards">Compliance &amp; Standards<a class="headerlink" href="#compliance-standards" title="Permanent link">&para;</a></h2>
<h3 id="security-standards-alignment">Security Standards Alignment<a class="headerlink" href="#security-standards-alignment" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>OWASP Top 10</strong>: Protection against common web vulnerabilities</li>
<li><strong>NIST Cybersecurity Framework</strong>: Risk-based security approach</li>
<li><strong>ISO 27001</strong>: Information security management practices</li>
</ul>
<h3 id="data-protection">Data Protection<a class="headerlink" href="#data-protection" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>No Personal Data</strong>: Service doesn't collect or store personal information</li>
<li><strong>Minimal Data Collection</strong>: Only necessary operational data</li>
<li><strong>Data Retention</strong>: Configurable log retention periods</li>
<li><strong>Privacy by Design</strong>: Default configurations prioritize privacy</li>
</ul>
<h2 id="security-development-guidelines">Security Development Guidelines<a class="headerlink" href="#security-development-guidelines" title="Permanent link">&para;</a></h2>
<h3 id="secure-coding-practices">Secure Coding Practices<a class="headerlink" href="#secure-coding-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Input Validation</strong></li>
<li>Validate all inputs at API boundaries</li>
<li>Use allowlists instead of blocklists</li>
<li>
<p>Sanitize data before processing</p>
</li>
<li>
<p><strong>Error Handling</strong></p>
</li>
<li>Don't expose internal system information</li>
<li>Log detailed errors securely</li>
<li>
<p>Return generic error messages to clients</p>
</li>
<li>
<p><strong>Authentication</strong></p>
</li>
<li>Always verify API keys for admin operations</li>
<li>Check permissions before processing requests</li>
<li>Use secure comparison functions</li>
</ol>
<h3 id="code-review-security-checklist">Code Review Security Checklist<a class="headerlink" href="#code-review-security-checklist" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] New endpoints have appropriate authentication</li>
<li>[ ] Permission checks implemented for admin operations</li>
<li>[ ] Input validation implemented</li>
<li>[ ] Error handling doesn't leak information</li>
<li>[ ] Security logging added for sensitive operations</li>
<li>[ ] Tests cover security scenarios</li>
</ul>
<h2 id="security-contact-information">Security Contact Information<a class="headerlink" href="#security-contact-information" title="Permanent link">&para;</a></h2>
<p>For security issues and responsible disclosure:</p>
<ul>
<li><strong>Security Email</strong>: security@yourcompany.com</li>
<li><strong>Response Time</strong>: 24-48 hours for initial response</li>
<li><strong>Encryption</strong>: PGP key available on company website</li>
</ul>
<h3 id="responsible-disclosure">Responsible Disclosure<a class="headerlink" href="#responsible-disclosure" title="Permanent link">&para;</a></h3>
<p>We appreciate security researchers who help improve our security. Please:</p>
<ol>
<li>Report vulnerabilities privately first</li>
<li>Allow reasonable time for fixes</li>
<li>Avoid accessing or modifying user data</li>
<li>Don't perform DDoS or destructive testing</li>
</ol>
<h2 id="appendix">Appendix<a class="headerlink" href="#appendix" title="Permanent link">&para;</a></h2>
<h3 id="security-references">Security References<a class="headerlink" href="#security-references" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://owasp.org/www-project-api-security/">OWASP API Security Top 10</a></li>
<li><a href="https://www.nist.gov/cyberframework">NIST Cybersecurity Framework</a></li>
<li><a href="https://golang.org/doc/security">Go Security Best Practices</a></li>
</ul>
<h3 id="security-tools">Security Tools<a class="headerlink" href="#security-tools" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Static Analysis</strong>: <code>gosec</code>, <code>govulncheck</code></li>
<li><strong>Dependency Scanning</strong>: <code>nancy</code>, <code>snyk</code></li>
<li><strong>Penetration Testing</strong>: <code>burp suite</code>, <code>owasp zap</code></li>
<li><strong>Monitoring</strong>: <code>prometheus</code>, <code>grafana</code></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 Griffin Skudder
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/griffinskudder/updater" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "search.highlight", "search.share", "toc.follow", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>